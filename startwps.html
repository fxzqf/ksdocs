<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>启动wps表格助手</title>
    <script src="./js/wpsjsrpcsdk.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <!--button  type="button" onclick="closeMe()">启动WPS表格助手</button-->
    <!--a href="javascript:window.opener=null;window.open('','_self');window.close();">关闭</a-->
    <script>
        window.onload = () => {
            let url = location.href.split("?");
            WpsInvoke.InvokeAsHttp(
                WpsInvoke.ClientType.et,
                "wpsapp",
                "openBook",
                JSON.stringify(url.length > 1 ? url[1] : null), () => { }, true, "https://fxzqf.github.io/wpsapp/jsplugins.xml", false);
        }

        /*
                var element = { "name": "wpsapp", "addonType": "et", "online": "true", "multiUser": "false", "url": "https://fxzqf.github.io/wpsapp/" };
        
                //WpsAddonMgr.disable(element, function (result) { });
                WpsAddonMgr.getAllConfig(function (e) {
                    if (!e.response || e.response.indexOf("null") >= 0) { }//本地没有加载项，直接安装
                    else {
                        alert(JSON.parse(e.response)[0].name);
                    }
                }
                )
        
                WpsAddonMgr.enable(element, function (result) {
                    if (result.status) {
                        //console.log(result.msg)
                    } else {
                        //let url = location.href.split("?");
                        //WpsInvoke.InvokeAsHttp(
                        //    WpsInvoke.ClientType.et,
                        //    "wpsapp",
                        //    "openBook",
                        //    JSON.stringify(url.length > 1 ? url[1] : null), () => { }, true, "https://fxzqf.github.io/wpsapp/jsplugins.xml", false);
                    }
                });
        */
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>启动wps表格助手</title>
    <script src="./js/wpsjsrpcsdk.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <!--button  type="button" onclick="closeMe()">启动WPS表格助手</button-->
    <!--a href="javascript:window.opener=null;window.open('','_self');window.close();">关闭</a-->
    <script>
        var element = { "name": "wpsapp", "addonType": "et", "online": "true", "multiUser": "false", "url": "https://fxzqf.github.io/wpsapp/" };
        var installed = false;
        WpsAddonMgr.getAllConfig(function (e) {
            
            
            if (!e.response || e.response.indexOf("null") >= 0) { }
            else {
                
                JSON.parse(e.response).forEach(e1 => {
                    if (e1.url = element.rul) installed = true;
                    
                });
            }
        });
        
        if (!installed) {
            alert(installed);    
            WpsAddonMgr.disable(element, function (result) { });
            WpsAddonMgr.enable(element, function (result) { });
        }


        /*
        window.onload = () => {
            //let url = location.href.split("?");
            WpsInvoke.InvokeAsHttp(
                WpsInvoke.ClientType.et,
                "wpsapp",
                "",
                JSON.stringify(null), () => { }, true, "https://fxzqf.github.io/wpsapp/jsplugins.xml", false);
        }

        
        
        
                //WpsAddonMgr.disable(element, function (result) { });
                
        
                WpsAddonMgr.enable(element, function (result) {
                    if (result.status) {
                        //console.log(result.msg)
                    } else {
                        //let url = location.href.split("?");
                        //WpsInvoke.InvokeAsHttp(
                        //    WpsInvoke.ClientType.et,
                        //    "wpsapp",
                        //    "openBook",
                        //    JSON.stringify(url.length > 1 ? url[1] : null), () => { }, true, "https://fxzqf.github.io/wpsapp/jsplugins.xml", false);
                    }
                });
        */
    </script>
</body>

</html>